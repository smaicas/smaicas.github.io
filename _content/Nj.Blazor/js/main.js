function y(){window.LocalizationJs=new f.LocalizationJsClass}var f;(i=>{class o{async Get(){return window.localStorage["nj-culture"]}async Set(e){window.localStorage["nj-culture"]=e}}i.LocalizationJsClass=o})(f||(f={}));y();var S=(i=>(i[i.None=0]="None",i[i.Error=1]="Error",i[i.Warning=2]="Warning",i[i.Info=3]="Info",i[i.Debug=4]="Debug",i))(S||{});const m=["","\x1B[31m","\x1B[33m","\x1B[36m","\x1B[35m"];class k{constructor(o){this.Level=4,this.className="",this.className=o.name??""}Error(o){this.Log(o==null?void 0:o.toString(),1)}Warn(o){this.Log(o==null?void 0:o.toString(),2)}Info(o){this.Log(o==null?void 0:o.toString(),3)}Debug(o){this.Log(o==null?void 0:o.toString(),4)}Log(o,c){if(o||console.log(o),c<=this.Level){const e=m[c],t=`[${S[c].toUpperCase()}][${this.className}] ${o}`;console.log(`${e}${t}\x1B[0m`)}}}function M(){window.DOMJs=new h.DOMJsClass}var h;(i=>{class o{constructor(){this.logger=new k(o),this.mouseMoveHandlers=new WeakMap,this.resizeCallbackEvents=new WeakMap,this.textPatternClickEvents=new WeakMap,this.textPatternInputEvents=new WeakMap,this.textPatternBlurEvents=new WeakMap,this.addTextPatternEvents=(e,t,n)=>{const s=()=>this.selectTextOnClick(e);this.textPatternClickEvents.get(e)||(e.addEventListener("click",s),this.textPatternClickEvents.set(e,s));const r=()=>this.goNextOrPrevent(e,t,n);this.textPatternInputEvents.get(e)||(e.addEventListener("input",r),this.textPatternInputEvents.set(e,r));const a=()=>this.setDefaultValueNotLength(e,n);this.textPatternBlurEvents.get(e)||(e.addEventListener("blur",a),this.textPatternBlurEvents.set(e,a))},this.selectTextOnClick=e=>{const t=document.createRange();t.selectNodeContents(e);const n=window.getSelection();n.removeAllRanges(),n.addRange(t)},this.goNextOrPrevent=(e,t,n)=>{if(e.innerText.length==0){e.innerText=n.defaultValue;return}if(e.innerText.length<=n.length){let s=this.getCursorPositionWithinSpan(e),r=n.pattern.replace(/[\\\(\)\^\$]/g,""),a=e.innerText,d=r.substring(0,a.length).split(""),u="";for(let l=0;l<a.length;l++){let g;d[l]==="w"?g=new RegExp("[a-zA-Z]","g").test(a[l]):d[l]==="d"&&(g=new RegExp("[0-9]","g").test(a[l])),g?u+=a[l]:s=s-1}if(e.innerText=u,this.setCursorPositionWithinSpan(e,s),e.innerText.length>=n.length){const l=this.findNextEditableBlock(t,e);l&&l.click()}}else e.innerText=e.innerText.substring(0,n.length),this.placeCaretAtEnd(e)},this.setDefaultValueNotLength=(e,t)=>{if(e.innerText.length!=t.length){e.innerText=t.defaultValue;return}},this.getCursorPositionWithinSpan=e=>{let t=0;if(window.getSelection){let n=window.getSelection();if(n&&n.rangeCount>0){let s=n.getRangeAt(0),r=s.cloneRange();r.selectNodeContents(e),r.setEnd(s.startContainer,s.startOffset),t=r.toString().length}}return t},this.setCursorPositionWithinSpan=(e,t)=>{let n=document.createRange(),s=window.getSelection();s&&(n.setStart(e.childNodes[0]||e,t),n.collapse(!0),s.removeAllRanges(),s.addRange(n))},this.findNextEditableBlock=(e,t)=>{let n=!1;for(const s of e.children)if(s===t)n=!0;else if(n&&s instanceof HTMLSpanElement&&s.contentEditable==="true")return s;return null},this.placeCaretAtEnd=e=>{const t=document.createRange(),n=window.getSelection();t.selectNodeContents(e),t.collapse(!1),n&&(n.removeAllRanges(),n.addRange(t))},this.inputFileHandlers=new WeakMap}async SetCssVariable(e,t){this.logger.Debug("Set CSS Variable"),this.logger.Debug(`${e} = ${t}`),document.documentElement.style.setProperty(e,t)}async GetCssVariable(e){return getComputedStyle(document.documentElement).getPropertyValue(e)}async SaveLocalStorage(e,t){localStorage.setItem(e,t)}async GetLocalStorage(e){return localStorage.getItem(e)}async GetDivContent(e){return e.innerText}async SetDivContent(e,t){return e.innerText=t,e.innerText}async SelectText(e){const t=document.createRange();t.selectNodeContents(e);const n=window.getSelection();n.removeAllRanges(),n.addRange(t)}async EnableMouseMove(e,t){if(this.mouseMoveHandlers.get(e))return;const n=s=>{t.invokeMethodAsync("NotifyMouseMove",s.clientX,s.clientY)};e.addEventListener("mousemove",n),this.mouseMoveHandlers.set(e,n)}async DisableMouseMove(e){const t=this.mouseMoveHandlers.get(e);t&&(e.removeEventListener("mousemove",t),this.mouseMoveHandlers.delete(e))}async GetCoordsRelative(e,t){let n=[0,0,0,0],s=e.getBoundingClientRect().height,r=e.getBoundingClientRect().width;switch(t){case"center":return[0,0,0,0];case"top":return[0,0,s,0];case"right":return[0,0,0,r];case"bottom":return[s,0,0,0];case"left":return[0,r,0,0];case"topleft":return[0,r,s,0];case"topright":return[0,0,s,r];case"bottomleft":return[s,r,0,0];case"bottomright":return[s,0,0,r]}return n}async ShowPicker(e){"showPicker"in HTMLInputElement.prototype&&e.showPicker()}async GetWindowWidth(){return window.innerWidth}async AddResizeCallback(e,t){if(!this.resizeCallbackEvents.get(e)){let n;const s=r=>{clearTimeout(n),n=setTimeout(function(){e.invokeMethodAsync(t)},500)};window.addEventListener("resize",s),this.textPatternClickEvents.set(e,s)}}async TextPatternAddDynamic(e,t){e.innerHTML="",this.textPatternClickEvents=new WeakMap,this.textPatternInputEvents=new WeakMap,this.textPatternBlurEvents=new WeakMap;for(let n of t){let s=document.createElement("span");if(s.innerText=n.value,n.isSeparator){e.appendChild(s);continue}n.isEditable&&(s.setAttribute("contenteditable","true"),this.addTextPatternEvents(s,e,n)),e.appendChild(s)}}async GetFocusedElementClass(){return document.activeElement.classList.toString()}async InputFileInitializeCallbacks(e,t){if(this.inputFileHandlers.get(t))return;const n=s=>{const r=t.files;if(r){let a=[];for(let d=0;d<r.length;d++){let u=r.item(d);a.push({id:d,name:u.name,size:u.size,contentType:u.type,lastModified:new Date(u.lastModified).toISOString()})}e.invokeMethodAsync("NotifyChange",a)}};t.addEventListener("change",n),this.inputFileHandlers.set(t,n)}async ReadFileData(e,t){const n=e.files.item(t);return await this.readFileStreamAsync(n)}async ReadImageData(e,t){const n=e.files.item(t);return await this.readFileDataAsync(n)}async readFileDataAsync(e){return new Promise((t,n)=>{const s=new FileReader;s.onload=()=>{t(s.result)},s.onerror=r=>{n(r)},s.readAsDataURL(e)})}async readFileStreamAsync(e){return new Promise((t,n)=>{const s=new FileReader;s.onload=()=>{t(s.result)},s.onerror=r=>{n(r)},s.readAsArrayBuffer(e)})}async SetDisabled(e,t){e.disabled=t}async FocusElement(e,t){var n,s;t?(n=t.querySelector(e))==null||n.focus():(s=document.querySelector(e))==null||s.focus()}async ScrollToClosest(e,t){let n=null;t?n=t.matches(e)?t:t.closest(e):n=document.querySelector(e),n&&n.scrollIntoView({behavior:"smooth",block:"start"})}async ScrollTop(e,t){t??(t=0),e?e.scrollTop=t:document.querySelector("body").scrollTop=t}async DownloadFile(e,t,n="text/plain"){const s=new Blob([t],{type:n}),r=window.URL.createObjectURL(s),a=document.createElement("a");a.href=r,a.download=e,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(r),document.body.removeChild(a)}}i.DOMJsClass=o})(h||(h={}));M();function v(){window.ThemeJs=new w.ThemeClass}var w;(i=>{const o="nj-darkmode";class c{constructor(){this.dom=new h.DOMJsClass,this.logger=new k(c),this.logger.Level=S.Error}async InitializeAsync(){let t=await this.LocalStorageIsDarkMode();if(t!==null){await this.SetDarkMode(t);return}let n=await this.UserPreferenceIsDarkMode();if(n!==null){await this.SetDarkMode(n);return}await await this.SetDarkMode(!1)}async SetDarkMode(t){document.documentElement.classList.remove("dark"),document.documentElement.classList.remove("light"),document.documentElement.classList.add(t?"dark":"light"),await this.dom.SaveLocalStorage(o,t.toString())}async ToggleDarkMode(){let t=!await this.IsDarkMode();return this.SetDarkMode(t),t}async IsDarkMode(){return await this.LocalStorageIsDarkMode(),await this.LocalStorageIsDarkMode()}async LocalStorageIsDarkMode(){const t=await this.dom.GetLocalStorage(o);return t?t==="true":null}async UserPreferenceIsDarkMode(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches}}i.ThemeClass=c})(w||(w={}));v();
