var f=(l=>(l[l.None=0]="None",l[l.Error=1]="Error",l[l.Warning=2]="Warning",l[l.Info=3]="Info",l[l.Debug=4]="Debug",l))(f||{});const w=["","\x1B[31m","\x1B[33m","\x1B[36m","\x1B[35m"];class y{constructor(o){this.Level=4,this.className="",this.className=o.name??""}Error(o){this.Log(o==null?void 0:o.toString(),1)}Warn(o){this.Log(o==null?void 0:o.toString(),2)}Info(o){this.Log(o==null?void 0:o.toString(),3)}Debug(o){this.Log(o==null?void 0:o.toString(),4)}Log(o,u){if(o||console.log(o),u<=this.Level){const e=w[u],t=`[${f[u].toUpperCase()}][${this.className}] ${o}`;console.log(`${e}${t}\x1B[0m`)}}}function v(){window.DOMJs=new g.DOMJsClass}var g;(l=>{class o{constructor(){this.logger=new y(o),this.mouseMoveHandlers=new WeakMap,this.resizeCallbackEvents=new WeakMap,this.textPatternClickEvents=new WeakMap,this.textPatternInputEvents=new WeakMap,this.textPatternBlurEvents=new WeakMap,this.addTextPatternEvents=(e,t,n)=>{const i=()=>this.selectTextOnClick(e);this.textPatternClickEvents.get(e)||(e.addEventListener("click",i),this.textPatternClickEvents.set(e,i));const s=()=>this.goNextOrPrevent(e,t,n);this.textPatternInputEvents.get(e)||(e.addEventListener("input",s),this.textPatternInputEvents.set(e,s));const r=()=>this.setDefaultValueNotLength(e,n);this.textPatternBlurEvents.get(e)||(e.addEventListener("blur",r),this.textPatternBlurEvents.set(e,r))},this.selectTextOnClick=e=>{const t=document.createRange();t.selectNodeContents(e);const n=window.getSelection();n.removeAllRanges(),n.addRange(t)},this.goNextOrPrevent=(e,t,n)=>{if(e.innerText.length==0){e.innerText=n.defaultValue;return}if(e.innerText.length<=n.length){let i=this.getCursorPositionWithinSpan(e),s=n.pattern.replace(/[\\\(\)\^\$]/g,""),r=e.innerText,c=s.substring(0,r.length).split(""),d="";for(let a=0;a<r.length;a++){let h;c[a]==="w"?h=new RegExp("[a-zA-Z]","g").test(r[a]):c[a]==="d"&&(h=new RegExp("[0-9]","g").test(r[a])),h?d+=r[a]:i=i-1}if(e.innerText=d,this.setCursorPositionWithinSpan(e,i),e.innerText.length>=n.length){const a=this.findNextEditableBlock(t,e);a&&a.click()}}else e.innerText=e.innerText.substring(0,n.length),this.placeCaretAtEnd(e)},this.setDefaultValueNotLength=(e,t)=>{if(e.innerText.length!=t.length){e.innerText=t.defaultValue;return}},this.getCursorPositionWithinSpan=e=>{let t=0;if(window.getSelection){let n=window.getSelection();if(n&&n.rangeCount>0){let i=n.getRangeAt(0),s=i.cloneRange();s.selectNodeContents(e),s.setEnd(i.startContainer,i.startOffset),t=s.toString().length}}return t},this.setCursorPositionWithinSpan=(e,t)=>{let n=document.createRange(),i=window.getSelection();i&&(n.setStart(e.childNodes[0]||e,t),n.collapse(!0),i.removeAllRanges(),i.addRange(n))},this.findNextEditableBlock=(e,t)=>{let n=!1;for(const i of e.children)if(i===t)n=!0;else if(n&&i instanceof HTMLSpanElement&&i.contentEditable==="true")return i;return null},this.placeCaretAtEnd=e=>{const t=document.createRange(),n=window.getSelection();t.selectNodeContents(e),t.collapse(!1),n&&(n.removeAllRanges(),n.addRange(t))},this.inputFileHandlers=new WeakMap}async SetCssVariable(e,t){this.logger.Debug("Set CSS Variable"),this.logger.Debug(`${e} = ${t}`),document.documentElement.style.setProperty(e,t)}async GetCssVariable(e){return getComputedStyle(document.documentElement).getPropertyValue(e)}async SaveLocalStorage(e,t){localStorage.setItem(e,t)}async GetLocalStorage(e){return localStorage.getItem(e)}async GetDivContent(e){return e.innerText}async SetDivContent(e,t){return e.innerText=t,e.innerText}async SelectText(e){const t=document.createRange();t.selectNodeContents(e);const n=window.getSelection();n.removeAllRanges(),n.addRange(t)}async EnableMouseMove(e,t){if(this.mouseMoveHandlers.get(e))return;const n=i=>{t.invokeMethodAsync("NotifyMouseMove",i.clientX,i.clientY)};e.addEventListener("mousemove",n),this.mouseMoveHandlers.set(e,n)}async DisableMouseMove(e){const t=this.mouseMoveHandlers.get(e);t&&(e.removeEventListener("mousemove",t),this.mouseMoveHandlers.delete(e))}async GetCoordsRelative(e,t){let n=[0,0,0,0],i=e.getBoundingClientRect().height,s=e.getBoundingClientRect().width;switch(t){case"center":return[0,0,0,0];case"top":return[0,0,i,0];case"right":return[0,0,0,s];case"bottom":return[i,0,0,0];case"left":return[0,s,0,0];case"topleft":return[0,s,i,0];case"topright":return[0,0,i,s];case"bottomleft":return[i,s,0,0];case"bottomright":return[i,0,0,s]}return n}async ShowPicker(e){"showPicker"in HTMLInputElement.prototype&&e.showPicker()}async GetWindowWidth(){return window.innerWidth}async AddResizeCallback(e,t){if(!this.resizeCallbackEvents.get(e)){let n;const i=s=>{clearTimeout(n),n=setTimeout(function(){e.invokeMethodAsync(t)},500)};window.addEventListener("resize",i),this.textPatternClickEvents.set(e,i)}}async TextPatternAddDynamic(e,t){e.innerHTML="",this.textPatternClickEvents=new WeakMap,this.textPatternInputEvents=new WeakMap,this.textPatternBlurEvents=new WeakMap;for(let n of t){let i=document.createElement("span");if(i.innerText=n.value,n.isSeparator){e.appendChild(i);continue}n.isEditable&&(i.setAttribute("contenteditable","true"),this.addTextPatternEvents(i,e,n)),e.appendChild(i)}}async GetFocusedElementClass(){return document.activeElement.classList.toString()}async InputFileInitializeCallbacks(e,t){if(this.inputFileHandlers.get(t))return;const n=i=>{const s=t.files;if(s){let r=[];for(let c=0;c<s.length;c++){let d=s.item(c);r.push({id:c,name:d.name,size:d.size,contentType:d.type,lastModified:new Date(d.lastModified).toISOString()})}e.invokeMethodAsync("NotifyChange",r)}};t.addEventListener("change",n),this.inputFileHandlers.set(t,n)}async ReadFileData(e,t){const n=e.files.item(t);return await this.readFileStreamAsync(n)}async ReadImageData(e,t){const n=e.files.item(t);return await this.readFileDataAsync(n)}async readFileDataAsync(e){return new Promise((t,n)=>{const i=new FileReader;i.onload=()=>{t(i.result)},i.onerror=s=>{n(s)},i.readAsDataURL(e)})}async readFileStreamAsync(e){return new Promise((t,n)=>{const i=new FileReader;i.onload=()=>{t(i.result)},i.onerror=s=>{n(s)},i.readAsArrayBuffer(e)})}async SetDisabled(e,t){e.disabled=t}async FocusElement(e,t){var n,i;t?(n=t.querySelector(e))==null||n.focus():(i=document.querySelector(e))==null||i.focus()}async ScrollToClosest(e,t){let n=null;t?n=t.matches(e)?t:t.closest(e):n=document.querySelector(e),n&&n.scrollIntoView({behavior:"smooth",block:"start"})}async ScrollTop(e,t){t??(t=0),e?e.scrollTop=t:document.querySelector("body").scrollTop=t}async DownloadFile(e,t,n="text/plain"){const i=new Blob([t],{type:n}),s=window.URL.createObjectURL(i),r=document.createElement("a");r.href=s,r.download=e,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(s),document.body.removeChild(r)}}l.DOMJsClass=o})(g||(g={}));v();
